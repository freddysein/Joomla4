var databaseKey=null,databaseThrottle=100,databasePasswordMessage="",databasePrefixMessage="",databaseEmptyMessage="",databaseHasWarnings=!1,databaseLogFile="",databaseResumeRetry=0,databaseResumeTimer=null;function toggleHelp(){for(var a,b=document.querySelectorAll(".akeeba-help-text"),c=0;c<b.length;c++){if(a=b[c],"none"===a.style.display){a.style.display="block";continue}a.style.display="none"}}function databaseRunRestoration(a){databaseKey=a;var b={view:"dbrestore",task:"start",format:"json",key:databaseKey,dbinfo:{}};b.dbinfo.dbtype=document.getElementById("dbtype").value,b.dbinfo.dbhost=document.getElementById("dbhost").value,b.dbinfo.dbuser=document.getElementById("dbuser").value,b.dbinfo.dbpass=document.getElementById("dbpass").value,b.dbinfo.dbname=document.getElementById("dbname").value,b.dbinfo.dbencryption=0,b.dbinfo.prefix=document.getElementById("prefix").value,b.dbinfo.existing=document.getElementById("existing").value,b.dbinfo.foreignkey=+document.getElementById("foreignkey").checked,b.dbinfo.noautovalue=+document.getElementById("noautovalue").checked,b.dbinfo.replace=+document.getElementById("replace").checked,b.dbinfo.utf8db=+document.getElementById("utf8db").checked,b.dbinfo.utf8tables=+document.getElementById("utf8tables").checked,b.dbinfo.utf8mb4=+document.getElementById("utf8mb4").checked,b.dbinfo.break_on_failed_create=+document.getElementById("break_on_failed_create").checked,b.dbinfo.break_on_failed_insert=+document.getElementById("break_on_failed_insert").checked,b.dbinfo.maxexectime=document.getElementById("maxexectime").value,b.dbinfo.throttle=document.getElementById("throttle").value,document.getElementById("dbport")&&(b.dbinfo.dbport=document.getElementById("dbport").value,b.dbinfo.dbsocket=document.getElementById("dbsocket").value),document.getElementById("dbencryption")&&(b.dbinfo.dbencryption=+document.getElementById("dbencryption").checked,b.dbinfo.dbsslcipher=document.getElementById("dbsslcipher").value,b.dbinfo.dbsslca=document.getElementById("dbsslca").value,b.dbinfo.dbsslkey=document.getElementById("dbsslkey").value,b.dbinfo.dbsslcert=document.getElementById("dbsslcert").value,b.dbinfo.dbsslverifyservercert=+document.getElementById("dbsslverifyservercert").checked);var c=document.getElementById("specific_tables");if(c){for(var d=[],e=0;e<c.length;e++)c.options[e].selected&&d.push(c.options[e].value);b.specific_tables=d}var f=b.dbinfo.throttle;f=Math.min(f,100),f=Math.max(f,6e4);(!databasePrefixMessage.length||!1===/[A-Z]{1,}/.test(b.dbinfo.prefix)||window.confirm(databasePrefixMessage))&&(!databasePasswordMessage.length||!1!==/^[a-zA-Z0-9- ]*$/.test(b.dbinfo.dbpass)||window.confirm(databasePasswordMessage))&&(!databaseEmptyMessage.length||b.dbinfo.dbhost.length&&b.dbinfo.dbuser.length&&b.dbinfo.dbpass.length&&b.dbinfo.dbname.length&&b.dbinfo.prefix.length||window.confirm(databaseEmptyMessage))&&(document.getElementById("restoration-progress-bar").style.width="0%",document.getElementById("restoration-progress-bar-text").innerText="0%",document.getElementById("restoration-lbl-restored").innerText="",document.getElementById("restoration-lbl-total").innerText="",document.getElementById("restoration-lbl-eta").innerText="",document.getElementById("restoration-progress").style.display="block",document.getElementById("restoration-success").style.display="none",document.getElementById("restoration-error").style.display="none",document.getElementById("restoration-retry").style.display="none",akeeba.Modal.open({inherit:"#restoration-dialog",width:"80%",lock:!0}),databaseResumeRetry=0,databaseHasWarnings=!1,databaseLogFile="",document.getElementById("restoration-warnings").style.display="none",akeebaAjax.callJSON(b,databaseParseRestoration,databaseEndWithErrorRestoration))}function databaseParseRestoration(a){return""==a.error?1==a.done?(document.getElementById("restoration-progress").style.display="none",document.getElementById("restoration-success").style.display="block",document.getElementById("restoration-error").style.display="none",document.getElementById("restoration-retry").style.display="none",document.getElementById("restoration-success-nowarnings").style.display="block",document.getElementById("restoration-success-warnings").style.display="none",void(databaseHasWarnings&&(document.getElementById("restoration-success-nowarnings").style.display="hide",document.getElementById("restoration-success-warnings").style.display="show",document.getElementById("restoration-sql-log").innerText=databaseLogFile))):void(document.getElementById("restoration-progress").style.display="block",document.getElementById("restoration-success").style.display="none",document.getElementById("restoration-error").style.display="none",document.getElementById("restoration-progress-bar").style.width=a.percent+"%",document.getElementById("restoration-progress-bar-text").innerText=a.percent+"%",document.getElementById("restoration-lbl-restored").innerText=a.restored,document.getElementById("restoration-lbl-total").innerText=a.total,document.getElementById("restoration-lbl-eta").innerText=a.eta,!databaseHasWarnings&&0<a.errorcount&&(databaseHasWarnings=!0,databaseLogFile=a.errorlog,document.getElementById("restoration-warnings").style.display="block",document.getElementById("restoration-inprogress-log").innerText=databaseLogFile),setTimeout(databaseStepRestoration,databaseThrottle)):void databaseErrorRestoration(a.error)}function databaseStepRestoration(){var a={view:"dbrestore",task:"step",format:"json",key:databaseKey};akeebaAjax.callJSON(a,databaseParseRestoration,databaseErrorRestoration)}function databaseErrorRestoration(a){return 3<databaseResumeRetry?void databaseEndWithErrorRestoration(a):void(databaseResumeRetry++,resetRetryTimeoutBar(),document.getElementById("restoration-progress").style.display="none",document.getElementById("restoration-success").style.display="none",document.getElementById("restoration-error").style.display="none",document.getElementById("restoration-error-message-retry").innerHTML=a,document.getElementById("restoration-retry").style.display="block",startRetryTimeoutBar())}function databaseEndWithErrorRestoration(a){document.getElementById("restoration-progress").style.display="none",document.getElementById("restoration-success").style.display="none",document.getElementById("restoration-error").style.display="block",document.getElementById("restoration-retry").style.display="none",document.getElementById("restoration-lbl-error").innerHTML=a,document.getElementById("akeeba-modal-close").style.visibility="visible"}function databaseBtnSuccessClick(){window.location=document.getElementById("btnSkip").href}function cancelResume(){resetRetryTimeoutBar();var a=document.getElementById("restoration-error-message-retry").innerHTML;return databaseEndWithErrorRestoration(a),!1}function resumeRestoration(){return resetRetryTimeoutBar(),document.getElementById("restoration-error").style.display="none",document.getElementById("restoration-retry").style.display="none",document.getElementById("restoration-progress").style.display="block",databaseStepRestoration(),!1}function resetRetryTimeoutBar(){clearInterval(databaseResumeTimer),document.getElementById("akeeba-retry-timeout").textContent="30"}function startRetryTimeoutBar(){var a=30;databaseResumeTimer=setInterval(function(){a--,document.getElementById("akeeba-retry-timeout").textContent=a.toFixed(0),0==a&&(clearInterval(databaseResumeTimer),resumeRestoration())},1e3)}function toggleSpecificTables(){var a=document.getElementById("specific_tables_cbx");if(a){a.addEventListener("click",function(){var a=document.getElementById("specific_tables");if(this.checked)$("#specific_tables_holder").show(),$("#specific_tables").chosen();else{for(var b=a.options,c=0;c<b.length;c++)b[c].selected=!1;$("#specific_tables_holder").hide(),$("#specific_tables").chosen("destroy")}});var b=document.getElementById("specific_tables_addall"),c=document.getElementById("specific_tables_clearall");b.addEventListener("click",function(){$("#specific_tables option").prop("selected",!0),$("#specific_tables").chosen().trigger("chosen:updated")}),c.addEventListener("click",function(){$("#specific_tables option:selected").removeAttr("selected"),$("#specific_tables").chosen().trigger("chosen:updated")})}}akeeba.System.documentReady(function(){toggleSpecificTables(),document.getElementById("restoration-cancel-resume").addEventListener("click",cancelResume),document.getElementById("restoration-resume").addEventListener("click",resumeRestoration)});

//# sourceMappingURL=database.min.js.map